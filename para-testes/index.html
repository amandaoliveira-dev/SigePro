<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Abas</title>

    <style>
        /* Estilo geral da página */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            margin: 40px;
            display: flex;
            justify-content: center;
        }

        .container-abas {
            width: 800px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-radius: 8px;
            background-color: #fff;
        }

        .aba-principal {
            background-color: #333;
            color: white;
            padding: 15px 20px;
            font-size: 1.2em;
            font-weight: bold;
        }

        /* Barra de sub-abas */
        .sub-abas {
            display: flex;
            border-bottom: 1px solid #ccc;
            background-color: #f9f9f9;
        }

        /* Botões da barra */
        .sub-aba-item {
            border: none;
            background-color: transparent;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 1em;
            border-right: 1px solid #ccc;
        }
        .sub-aba-item:hover {
            background-color: #e0e0e0;
        }

        /* Novo container que agrupa o botão e seu submenu */
        .menu-item-container {
            position: relative; /* ESSENCIAL: O submenu será posicionado em relação a este container */
        }

        /* Estilo do container do submenu (Nível 2) */
        .sub-abas-nivel2 {
            display: flex;
            flex-direction: column;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            padding: 0;
            position: absolute; /* Posicionado em relação ao .menu-item-container */
            top: 100%; /* Começa exatamente abaixo do container do botão */
            left: 0;   /* Alinhado à esquerda do container do botão */
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Botões dentro do submenu */
        .sub-abas-nivel2 .sub-aba-item-n2 {
            border: none;
            background-color: transparent;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 0.9em;
            color: #333;
            width: 100%;
            text-align: left;
            box-sizing: border-box;
            border-bottom: 1px solid #e9e9e9;
        }
        .sub-abas-nivel2 .sub-aba-item-n2:last-child {
            border-bottom: none;
        }
        .sub-abas-nivel2 .sub-aba-item-n2:hover {
            background-color: #e0e0e0;
        }

        /* Classe para esconder */
        .escondido {
            display: none;
        }

        /* Área de conteúdo principal */
        .conteudo-sub-abas {
            padding: 25px;
            min-height: 200px;
        }
    </style>
</head>
<body>

    <div class="container-abas">
        <div class="aba-principal">
            Venda
        </div>

        <div class="conteudo-principal">
            <div class="sub-abas">
                <div class="menu-item-container">
                    <button id="btn-analise" class="sub-aba-item">Análise de Dados</button>
                    <div id="abas-analise" class="sub-abas-nivel2 escondido">
                        <button class="sub-aba-item-n2">Dashboard de Vendas</button>
                        <button class="sub-aba-item-n2">Relatório do Dia</button>
                        <button class="sub-aba-item-n2">Histórico de Vendas</button>
                    </div>
                </div>

                <div class="menu-item-container">
                    <button id="btn-operacoes" class="sub-aba-item">Operações</button>
                    <div id="abas-operacoes" class="sub-abas-nivel2 escondido">
                        <button class="sub-aba-item-n2">Orçamento</button>
                        <button class="sub-aba-item-n2">Devoluções e trocas</button>
                    </div>
                </div>

                <button class="sub-aba-item">Cupons e Promoções</button>
            </div>

            <div class="conteudo-sub-abas">
                <p>Selecione uma sub-aba para ver seu conteúdo.</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
    
            /**
             * Função genérica para configurar um botão para abrir um submenu.
             * @param {string} idBotao - O ID do botão que será clicado.
             * @param {string} idSubmenu - O ID do submenu que será aberto.
             */
            function configurarSubmenu(idBotao, idSubmenu) {
                const botao = document.getElementById(idBotao);
                const submenu = document.getElementById(idSubmenu);

                if (!botao || !submenu) {
                    console.error("Botão ou submenu não encontrado:", idBotao, idSubmenu);
                    return;
                }
                
                // Função para ajustar apenas a largura. A posição já está correta pelo CSS.
                function ajustarLarguraSubmenu() {
                    const larguraBotao = botao.offsetWidth;
                    submenu.style.width = `${larguraBotao}px`;
                }

                ajustarLarguraSubmenu();
                window.addEventListener('resize', ajustarLarguraSubmenu);

                botao.addEventListener('click', function(event) {
                    event.stopPropagation();
                    const estaEscondido = submenu.classList.contains('escondido');
                    
                    // Fecha todos os outros submenus antes de decidir se abre o atual
                    document.querySelectorAll('.sub-abas-nivel2').forEach(outroSubmenu => {
                        if (outroSubmenu !== submenu) {
                            outroSubmenu.classList.add('escondido');
                        }
                    });
                    
                    // Alterna a visibilidade apenas do submenu clicado
                    submenu.classList.toggle('escondido');
                });
            }

            configurarSubmenu('btn-analise', 'abas-analise');
            configurarSubmenu('btn-operacoes', 'abas-operacoes');

            // Fecha os menus se clicar em qualquer outro lugar da página
            document.addEventListener('click', function() {
                document.querySelectorAll('.sub-abas-nivel2').forEach(submenu => {
                    submenu.classList.add('escondido');
                });
            });
        });
    </script>
</body>
</html>